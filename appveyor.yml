os:
  - Visual Studio 2017

configuration:
  - Debug
  - Release

environment:
  CTEST_OUTPUT_ON_FAILURE: 1

install:
  - vcpkg install protobuf
  - hg summary
  # ign-cmake
  - hg clone https://bitbucket.org/ignitionrobotics/ign-cmake
  - cd ign-cmake
  - hg up ign-cmake1
  - md build
  - cd build
  - cmake .. -DBUILD_TESTING=OFF
  - cmake --build . --target INSTALL
  # also build ign-cmake2
  - cd ..
  - md build2
  - cd build2
  - hg up ign-cmake2
  - cmake .. -DBUILD_TESTING=OFF
  - cmake --build . --target INSTALL
  - cd ../..
  # ign-math
  - hg clone https://bitbucket.org/ignitionrobotics/ign-math
  - cd ign-math
  - hg up ign-math6
  - md build
  - cd build
  - cmake .. -DBUILD_TESTING=OFF
  - cmake --build . --target INSTALL
  - cd ../..
build_script:
  - md build
  - cd build
  - cmake ..
      -DCMAKE_TOOLCHAIN_FILE=c:/tools/vcpkg/scripts/buildsystems/vcpkg.cmake
      #-DCMAKE_CXX_FLAGS="-WX"
  - cmake --build . --config %CONFIGURATION%

after_build:
  - cmake --build . --config %CONFIGURATION% --target INSTALL

#test_script:
#  - cmake --build . --config %CONFIGURATION% --target RUN_TESTS
